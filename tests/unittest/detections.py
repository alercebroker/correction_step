detections = [
    {
        "candid": 1000151433015015013,
        "oid": "ZTF19aaapkto",
        "mjd": 58754.151435200125,
        "fid": 2,
        "pid": 1000151433015.0,
        "diffmaglim": 20.465633392333984,
        "isdiffpos": 1.0,
        "nid": 1000,
        "ra": 252.6788849,
        "dec": 53.3452076,
        "magpsf": 19.28787612915039,
        "sigmapsf": 0.14646674692630768,
        "magap": 19.266599655151367,
        "sigmagap": 0.14499999582767487,
        "distnr": 0.28235432505607605,
        "rb": 0.9628571271896362,
        "rbversion": "t17_f5_c3",
        "drb": 0.9997630715370178,
        "drbversion": "d6_m7",
        "magapbig": 19.43600082397461,
        "sigmagapbig": 0.2150000035762787,
        "rfid": 796120230.0,
        "magpsf_corr": 18.266626688905735,
        "sigmapsf_corr": 0.05280014982302609,
        "sigmapsf_corr_ext": 0.05717935600963369,
        "corrected": True,
        "dubious": False,
        "parent_candid": None,
        "has_stamp": True,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 970288611915015003,
        "oid": "ZTF19aaapkto",
        "mjd": 58724.288611100055,
        "fid": 2,
        "pid": 970288611915.0,
        "diffmaglim": 20.193099975585938,
        "isdiffpos": 1.0,
        "nid": 970,
        "ra": 252.6788296,
        "dec": 53.3452352,
        "magpsf": 19.405500411987305,
        "sigmapsf": 0.12579399347305298,
        "magap": 19.185199737548828,
        "sigmagap": 0.15719999372959137,
        "distnr": 0.18734200298786163,
        "rb": 0.9871429800987244,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.155799865722656,
        "sigmagapbig": 0.19509999454021454,
        "rfid": None,
        "magpsf_corr": 18.331255907137233,
        "sigmapsf_corr": 0.04405369423855633,
        "sigmapsf_corr_ext": 0.04676943275406185,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 970289083015015009,
        "oid": "ZTF19aaapkto",
        "mjd": 58724.28908560006,
        "fid": 2,
        "pid": 970289083015.0,
        "diffmaglim": 20.040199279785156,
        "isdiffpos": 1.0,
        "nid": 970,
        "ra": 252.6788904,
        "dec": 53.3451641,
        "magpsf": 19.343799591064453,
        "sigmapsf": 0.16942499577999115,
        "magap": 19.77039909362793,
        "sigmagap": 0.30959999561309814,
        "distnr": 0.40978699922561646,
        "rb": 0.949999988079071,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.57699966430664,
        "sigmagapbig": 0.3312999904155731,
        "rfid": None,
        "magpsf_corr": 18.288118478699232,
        "sigmapsf_corr": 0.06004036472157424,
        "sigmapsf_corr_ext": 0.0640774231668381,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 970312031915015000,
        "oid": "ZTF19aaapkto",
        "mjd": 58724.31203699997,
        "fid": 1,
        "pid": 970312031915.0,
        "diffmaglim": 20.150299072265625,
        "isdiffpos": 1.0,
        "nid": 970,
        "ra": 252.6788933,
        "dec": 53.3453208,
        "magpsf": 19.499000549316406,
        "sigmapsf": 0.15687300264835358,
        "magap": 19.28860092163086,
        "sigmagap": 0.16140000522136688,
        "distnr": 0.2697399854660034,
        "rb": 0.9200000166893005,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.092599868774414,
        "sigmagapbig": 0.17180000245571136,
        "rfid": None,
        "magpsf_corr": 18.50728357185249,
        "sigmapsf_corr": 0.061404765337253434,
        "sigmapsf_corr_ext": 0.06293053419194773,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 970312523015015008,
        "oid": "ZTF19aaapkto",
        "mjd": 58724.31252310006,
        "fid": 1,
        "pid": 970312523015.0,
        "diffmaglim": 20.04520034790039,
        "isdiffpos": 1.0,
        "nid": 970,
        "ra": 252.67893,
        "dec": 53.3452722,
        "magpsf": 19.281099319458008,
        "sigmapsf": 0.17539599537849426,
        "magap": 19.423200607299805,
        "sigmagap": 0.20589999854564667,
        "distnr": 0.33620598912239075,
        "rb": 0.9685710072517395,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.370800018310547,
        "sigmagapbig": 0.2506999969482422,
        "rfid": None,
        "magpsf_corr": 18.41675530497813,
        "sigmapsf_corr": 0.07842883775120303,
        "sigmapsf_corr_ext": 0.07911923284144366,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 971262541915015026,
        "oid": "ZTF19aaapkto",
        "mjd": 58725.26254629996,
        "fid": 2,
        "pid": 971262541915.0,
        "diffmaglim": 20.500099182128906,
        "isdiffpos": 1.0,
        "nid": 971,
        "ra": 252.6788856,
        "dec": 53.3452218,
        "magpsf": 19.4950008392334,
        "sigmapsf": 0.11667399853467941,
        "magap": 19.837600708007812,
        "sigmagap": 0.23149999976158142,
        "distnr": 0.18107399344444275,
        "rb": 0.9542859792709351,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.676599502563477,
        "sigmagapbig": 0.25440001487731934,
        "rfid": None,
        "magpsf_corr": 18.363676288479866,
        "sigmapsf_corr": 0.03784272929299751,
        "sigmapsf_corr_ext": 0.04115705218917656,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 971263023015015012,
        "oid": "ZTF19aaapkto",
        "mjd": 58725.26302079996,
        "fid": 2,
        "pid": 971263023015.0,
        "diffmaglim": 20.31060028076172,
        "isdiffpos": 1.0,
        "nid": 971,
        "ra": 252.6789578,
        "dec": 53.3452136,
        "magpsf": 19.307100296020508,
        "sigmapsf": 0.13391900062561035,
        "magap": 19.353900909423828,
        "sigmagap": 0.186599999666214,
        "distnr": 0.4075010120868683,
        "rb": 0.9557139873504639,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.22949981689453,
        "sigmagapbig": 0.21230000257492065,
        "rfid": None,
        "magpsf_corr": 18.274092358171046,
        "sigmapsf_corr": 0.04675925493138566,
        "sigmapsf_corr_ext": 0.051717678800663726,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 971288341915015018,
        "oid": "ZTF19aaapkto",
        "mjd": 58725.288344900124,
        "fid": 1,
        "pid": 971288341915.0,
        "diffmaglim": 20.52050018310547,
        "isdiffpos": 1.0,
        "nid": 971,
        "ra": 252.6788725,
        "dec": 53.3452407,
        "magpsf": 19.32390022277832,
        "sigmapsf": 0.14964300394058228,
        "magap": 19.411100387573242,
        "sigmagap": 0.14059999585151672,
        "distnr": 0.09888499975204468,
        "rb": 0.9242860078811646,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.46269989013672,
        "sigmagapbig": 0.1868000030517578,
        "rfid": None,
        "magpsf_corr": 18.433616392623797,
        "sigmapsf_corr": 0.06463996869547953,
        "sigmapsf_corr_ext": 0.06590872124794477,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 971288813015015008,
        "oid": "ZTF19aaapkto",
        "mjd": 58725.28881940013,
        "fid": 1,
        "pid": 971288813015.0,
        "diffmaglim": 20.262699127197266,
        "isdiffpos": 1.0,
        "nid": 971,
        "ra": 252.6789566,
        "dec": 53.3452128,
        "magpsf": 19.23419952392578,
        "sigmapsf": 0.16007199883460999,
        "magap": 19.196699142456055,
        "sigmagap": 0.13950000703334808,
        "distnr": 0.4153299927711487,
        "rb": 0.9171429872512817,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.387100219726562,
        "sigmagapbig": 0.21140000224113464,
        "rfid": None,
        "magpsf_corr": 18.395348167165974,
        "sigmapsf_corr": 0.07321151204685963,
        "sigmapsf_corr_ext": 0.07392219011019217,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 972263991915015008,
        "oid": "ZTF19aaapkto",
        "mjd": 58726.2639930998,
        "fid": 2,
        "pid": 972263991915.0,
        "diffmaglim": 20.165700912475586,
        "isdiffpos": 1.0,
        "nid": 972,
        "ra": 252.6788369,
        "dec": 53.3452262,
        "magpsf": 19.461200714111328,
        "sigmapsf": 0.17502300441265106,
        "magap": 19.279399871826172,
        "sigmagap": 0.17110000550746918,
        "distnr": 0.18483899533748627,
        "rb": 0.9385709762573242,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.104799270629883,
        "sigmagapbig": 0.1860000044107437,
        "rfid": None,
        "magpsf_corr": 18.351632722119714,
        "sigmapsf_corr": 0.06092279558141949,
        "sigmapsf_corr_ext": 0.06298946762511073,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
    {
        "candid": 972264473015015016,
        "oid": "ZTF19aaapkto",
        "mjd": 58726.26447919989,
        "fid": 2,
        "pid": 972264473015.0,
        "diffmaglim": 20.094200134277344,
        "isdiffpos": 1.0,
        "nid": 972,
        "ra": 252.6789427,
        "dec": 53.3452696,
        "magpsf": 19.337200164794922,
        "sigmapsf": 0.15322500467300415,
        "magap": 19.38319969177246,
        "sigmagap": 0.20900000631809235,
        "distnr": 0.339803010225296,
        "rb": 0.9571430087089539,
        "rbversion": "t17_f5_c3",
        "drb": None,
        "drbversion": None,
        "magapbig": 19.38960075378418,
        "sigmagapbig": 0.2685000002384186,
        "rfid": None,
        "magpsf_corr": 18.28561782206513,
        "sigmapsf_corr": 0.053711676687009935,
        "sigmapsf_corr_ext": 0.0581696842178361,
        "corrected": True,
        "dubious": False,
        "parent_candid": 1.000151433015015e18,
        "has_stamp": False,
        "step_id_corr": "correction_test_0.0.1",
        "new": False,
    },
]

detections_not_db = [
    {
        "candid": 1000151433015015013,
        "jd": 2458754.6514352,
        "fid": 2,
        "pid": 1000151433015,
        "diffmaglim": 20.465633392333984,
        "pdiffimfilename": "ztf_20190928151377_000796_zr_c08_o_q3_scimrefdiffimg.fits",
        "programpi": "TESS",
        "programid": 1,
        "isdiffpos": 1.0,
        "tblid": 13,
        "nid": 1000,
        "rcid": 30,
        "field": 796,
        "xpos": 1001.656494140625,
        "ypos": 1858.2093505859375,
        "ra": 252.6788849,
        "dec": 53.3452076,
        "magpsf": 19.28787612915039,
        "sigmapsf": 0.14646674692630768,
        "chipsf": 2.3434598445892334,
        "magap": 19.266599655151367,
        "sigmagap": 0.14499999582767487,
        "distnr": 0.28235432505607605,
        "magnr": 18.803998947143555,
        "sigmagnr": 0.035999998450279236,
        "chinr": 1.4249999523162842,
        "sharpnr": 0.1080000028014183,
        "sky": 0.3195382058620453,
        "magdiff": -0.021276000887155533,
        "fwhm": 1.5499999523162842,
        "classtar": 0.9879999756813049,
        "mindtoedge": 1001.656494140625,
        "magfromlim": 1.1990339756011963,
        "seeratio": 1.4877525568008423,
        "aimage": 0.6669999957084656,
        "bimage": 0.5860000252723694,
        "aimagerat": 0.4303225874900818,
        "bimagerat": 0.37806451320648193,
        "elong": 1.1382251977920532,
        "nneg": 7,
        "nbad": 0,
        "rb": 0.9628571271896362,
        "ssdistnr": -999.0,
        "ssmagnr": -999.0,
        "ssnamenr": "null",
        "sumrat": 0.9127174615859985,
        "magapbig": 19.43600082397461,
        "sigmagapbig": 0.2150000035762787,
        "ranr": 252.6787835,
        "decnr": 53.3452599,
        "sgmag1": 19.30500030517578,
        "srmag1": 18.966899871826172,
        "simag1": 18.702800750732422,
        "szmag1": 18.36590003967285,
        "sgscore1": 0.5918239951133728,
        "distpsnr1": 0.14776396751403809,
        "ndethist": 1091,
        "ncovhist": 2783,
        "jdstarthist": 2458300.7176389,
        "jdendhist": 2458754.6514352,
        "scorr": 9.09324550628662,
        "tooflag": 0,
        "objectidps1": 172012526788744944,
        "objectidps2": 172012526809486623,
        "sgmag2": 20.36750030517578,
        "srmag2": 19.978599548339844,
        "simag2": 19.832300186157227,
        "szmag2": 19.578899383544922,
        "sgscore2": 0.0,
        "distpsnr2": 6.779681205749512,
        "objectidps3": 172012526810070353,
        "sgmag3": -999.0,
        "srmag3": 22.097200393676758,
        "simag3": 21.6112003326416,
        "szmag3": 21.168399810791016,
        "sgscore3": 0.1198749989271164,
        "distpsnr3": 14.831378936767578,
        "nmtchps": 8,
        "rfid": 796120230,
        "jdstartref": 2458187.006458,
        "jdendref": 2458218.979456,
        "nframesref": 15,
        "rbversion": "t17_f5_c3",
        "dsnrms": 8.138734817504883,
        "ssnrms": 20.96039581298828,
        "dsdiff": -12.821660995483398,
        "magzpsci": 26.080875396728516,
        "magzpsciunc": 3.8701000448782e-06,
        "magzpscirms": 0.03786600008606911,
        "nmatches": 812,
        "clrcoeff": 0.10301700234413147,
        "clrcounc": 6.418600150936982e-06,
        "zpclrcov": -4.590000116877491e-06,
        "zpmed": 26.14699935913086,
        "clrmed": 0.609000027179718,
        "clrrms": 0.30101698637008667,
        "neargaia": 0.14985106885433197,
        "neargaiabright": 43.299930572509766,
        "maggaia": 19.051651000976562,
        "maggaiabright": 13.047926902770996,
        "exptime": 30.0,
        "drb": 0.9997630715370178,
        "drbversion": "d6_m7",
        "objectId": "ZTF19aaapkto",
        "oid": "ZTF19aaapkto",
        "mjd": 58754.151435200125,
        "has_stamp": True,
        "step_id_corr": "correction_test_0.0.1",
        "corrected": True,
        "magpsf_corr": 18.266626688905735,
        "sigmapsf_corr": 0.05280014982302609,
        "sigmapsf_corr_ext": 0.05717935600963369,
        "dubious": False,
        "mjdstartref": 58186.506457999814,
        "mjdendref": 58218.47945600003,
    }
]
